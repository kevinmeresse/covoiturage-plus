<?php

/**
 * GroupeStat
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 *
 * @package    roulezmailn_v3
 * @subpackage model
 * @author     RoulezMalin <technique@roulezmalin.fr>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class GroupeStat extends BaseGroupeStat {
    public function __toString() {
        return $this->getIntitule();
    }


    /**
     * deserialisation des parametres des groupes et extraction des noms de villes avec séparation pour affichage
     *
     * @return  string      $liste_ville          retourne une chaine contenant le nom des villes séparées par un -  (ex Royan - Bordeaux - Pau)
     */
    public function getExtractNomVille() {

        //liste des villes de sortie
        $liste_ville = "";

        //récupération du tableau des villes
        $tab_ville = array();

        //de-serialisation
        $tab_ville = unserialize($this->getParametres());

        $i=0; //compteur de boucle
        $sep = " - "; //séparateur des villes dans la liste
        //parcours du tableau pour extraire uniquement les villes
        $i=0;
        foreach ($tab_ville as $key => $value) {
            if($i == 0) {
                $sep_alt = '';
            }else {
                $sep_alt = $sep;
            }

            $liste_ville .=  $sep_alt.$value;

            $i++;
        }


        return $liste_ville;

    }
    
    /**
     * deserialisation des parametres des groupes et extraction des noms de villes avec retour en tableau
     * 
     * @return  array      $tabNomVille          retourne un tableau contenant le nom des villes 
     */
    public function extractNomVilleTab() {
        
        //liste des villes de sortie
        $tabNomVille = array();
        
        //récupération du tableau des villes
        $tab_ville = array();
        
        //de-serialisation
        $tab_ville = unserialize($this->getParametres());
        
        //parcours du tableau pour extraire uniquement les villes

        foreach ($tab_ville as $key => $value) {
            
            $tabNomVille[] =  $value;

        }
        
        
        return $tabNomVille;
        
    }

    /**
     * deserialisation des parametres des groupe et extraction des id uniquement
     *
     * @return  array      $tabId                   retourne un tableau d'id (de villes)
     */

    public  function extractIdSerialiseGroupe() {
        //tableau servant à la deserialisation des parametres
        $tabUnserial = array();

        //tableau des id des villes de groupe (=> GroupeStat)
        $tabId = array();

        //deserailisation
        $tabUnserial = unserialize($this->getParametres());

        //récupération des id de ville
        foreach($tabUnserial as $key => $value) {
            $tabId[] = $key;
        }

        //tableau des code insee des villes de groupe (=> GroupeStat)
        $tabCdIn = array();

        $tabCdIn = Doctrine_Core::getTable('VilleFr')->getTabCdInsee($tabId);

        //return $tabId;
        return $tabCdIn;
    }
}
