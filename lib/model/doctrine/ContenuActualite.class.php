<?php

/**
 * ContenuActualite
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    roulezmailn_v3
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class ContenuActualite extends BaseContenuActualite {
 
    
    
    /*
     * récupération du chemin et du nom de la photo d'une actualité
     * retourne un string au format
     * "prefixe"_"id"."extension-fichier"
     *
     */

    public function getCheminPhotoActualite() {

        $affichage = '';
        if ($this->getPhotoResume() != null && $this->getPhotoResume() != '') {
            //nom de l'image du covoitureur
            $nom_image = sfConfig::get('sf_photo_actualite_prefixe') . $this->getIdActualite() . sfConfig::get('sf_extension_fichier_image');

            //nom du chemin de l'image
            $nom_chemin = sfConfig::get('sf_rep_commun_photo_actualite');

            //génération du code d'affichage de l'image
            $affichage = '<img src="' . $nom_chemin . $nom_image . '" title="image actualite">';
        }

        return $affichage;
    }

    /*
     * génération du nom de la photo d'une actualité
     * retourne un string au format
     * "prefixe"_"id"."extension-fichier"
     *
     */

    public function setCheminPhotoActualite() {

        //nom de l'image d'une actualité
        $nom_image = sfConfig::get('sf_photo_actualite_prefixe') . $this->getIdActualite() . sfConfig::get('sf_extension_fichier_image');

        //nom du chemin de l'image
        $nom_chemin = sfConfig::get('sf_web_dir') . sfConfig::get('sf_rep_ini_photo_actualite');

        return $nom_chemin . $nom_image;
    }

    /*
     * suppression de la photo
     *
     */

    public function deletePhotoActualite() {

        //url de l'image d'une actualité
        $url_photo = $this->setCheminPhotoActualite();

        //suppression de l'image et retour
        //si unlink a fonctionné => retour TRUE
        //si unlink n'a pas fonctionné => retour FALSE
        return(unlink($url_photo));
    }

    public function setThumbnailPhotoActualite() {

        //nom de l'image d'une actualité
        $nom_image = sfConfig::get('sf_thumb_actualite_prefixe') . $this->getIdActualite() . sfConfig::get('sf_extension_fichier_image');

        //nom du chemin de l'image
        $nom_chemin = sfConfig::get('sf_web_dir') . sfConfig::get('sf_rep_thumb_photo_actualite');

        return $nom_chemin . $nom_image;
    }

    public function getThumbnailPhotoActualite() {

        //nom de l'image d'une actualité
        $nom_image = sfConfig::get('sf_thumb_actualite_prefixe') . $this->getIdActualite() . sfConfig::get('sf_extension_fichier_image');

        //nom du chemin de l'image
        $nom_chemin = sfConfig::get('sf_rep_thumb_photo_actualite_spl');

        //génération du code d'affichage de l'image
        $affichage = '<img src="' . $nom_chemin . $nom_image . '" title="image actualite">';

        return $affichage;
    }

    /*
     * suppression du thumbnailde la photo
     *
     */

    public function deleteThumnailPhotoActualite() {

        //url de l'image d'une actualité
        $url_photo = $this->setThumbnailPhotoActualite();

        //suppression de l'image et retour
        //si unlink a fonctionné => retour TRUE
        //si unlink n'a pas fonctionné => retour FALSE
        return(unlink($url_photo));
    }

    /*
     * traitement de l'etat photo (changement de l'état 
     *   à partir de l'écran liste des photos
     *
     */

    public function traiteEtatPhotoActualite($etat_photo) {

        //mise à jour de l'etat_photo
        $this->setEtatPhoto($etat_photo);
        $this->save();

        return;
    }

}
